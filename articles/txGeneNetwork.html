<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Transcript, Gene and Gene-set network integration • txGeneNetwork</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/minty/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Transcript, Gene and Gene-set network integration">
<meta property="og:description" content="txGeneNetwork">
<meta property="og:image" content="https://luciorq.github.io/txGeneNetwork/logo.svg">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">txGeneNetwork</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/txGeneNetwork.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/luciorq/txGeneNetwork/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="txGeneNetwork_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Transcript, Gene and Gene-set network integration</h1>
                        <h4 class="author">Izabela Mamede Costa Andrade da Conceição</h4>
            <address class="author_afil">
      Departament of Genetics, Ecology and Evolution, Institute of Biological Sciences, Federal University of Minas Gerais (UFMG) - Brazil<br><a class="author_email" href="mailto:#"></a><a href="mailto:iza.mamede@gmail.com" class="email">iza.mamede@gmail.com</a>
      </address>
                              <h4 class="author">Lucio Rezende Queiroz</h4>
            <address class="author_afil">
      Departament of Biochemistry and Immunology, Institute of Biological Sciences, Federal University of Minas Gerais (UFMG) - Brazil<br><a class="author_email" href="mailto:#"></a><a href="mailto:luciorqueiroz@ufmg.br" class="email">luciorqueiroz@ufmg.br</a>
      </address>
                  
            <h4 class="date">09/07/2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/luciorq/txGeneNetwork/blob/master/vignettes/txGeneNetwork.Rmd"><code>vignettes/txGeneNetwork.Rmd</code></a></small>
      <div class="hidden name"><code>txGeneNetwork.Rmd</code></div>

    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>This workflow is a comprehensive guideline of how to construct Pathway-Gene-Transcript network from transcript expression data using the amazing packs <a href="https://github.com/thomasp85/tidygraph">tidygraph</a> and <a href="https://github.com/thomasp85/ggraph">ggraph</a>.</p>
    </div>
    
<!--
****
add to description
URL: https://usethis.r-lib.org, https://github.com/r-lib/usethis
BugReports: https://github.com/r-lib/usethis/issues
-->
<div id="workflow-version-information" class="section level1">
<h1 class="hasAnchor">
<a href="#workflow-version-information" class="anchor"></a>Workflow version information</h1>
<p><strong>R version</strong>: R version 4.0.2 (2020-06-22)</p>
<p><strong>Bioconductor version</strong>: 3.11</p>
<p><strong>Package</strong>: 0.0.0.9000</p>
</div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<!-- TODO Fazer uma introduçãozinha para a versão da revista -->
<!--

This workflow was motivated by ...

Functional analysis is widely used to ...

-->
</div>
<div id="getting-started" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-started" class="anchor"></a>Getting started</h1>
<p>Install and run all needed packages</p>
<div class="sourceCode" id="cb1"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://luciorq.github.io/txGeneNetwork">txGeneNetwork</a></span>)

<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://joelgombin.github.io/concaveman">concaveman</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://ggforce.data-imaginist.com">ggforce</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="http://readr.tidyverse.org">readr</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://tidyr.tidyverse.org">tidyr</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw">ggnewscale</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://tidygraph.data-imaginist.com">tidygraph</a></span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="kw"><a href="https://ggraph.data-imaginist.com">ggraph</a></span>)
</pre></div>
</div>
<div id="input-data" class="section level1">
<h1 class="hasAnchor">
<a href="#input-data" class="anchor"></a>Input data</h1>
<!--
Other Bioconductor packages that can be used to ...
-->
<div id="quick-start" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick Start</h2>
<p>Your input data must be organized as a .csv with <strong>From</strong> and <strong>To</strong> Columns, for this specific graph your from-to order would go Process -&gt; Gene and in another line Gene -&gt; Transcript</p>
<table class="table">
<thead><tr class="header">
<th>From</th>
<th>To</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Process_1</td>
<td>Gene_1</td>
</tr>
<tr class="even">
<td>Gene_1</td>
<td>Transcript_1</td>
</tr>
<tr class="odd">
<td>Gene_1</td>
<td>Transcript_2</td>
</tr>
</tbody>
</table>
<p>Other metadata columns which will correspond to the <strong>edges</strong> info can be added and will also be imported, for this type of network we add a Process column, or to which metabolic process that edge belongs to and a Direction column, to show if that transcript is up or down regulated in our example data.</p>
<table class="table">
<thead><tr class="header">
<th>From</th>
<th>To</th>
<th>Process</th>
<th>Direction</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>Process_1</td>
<td>Gene_1</td>
<td>Process_1</td>
<td>NA</td>
</tr>
<tr class="even">
<td>Gene_1</td>
<td>Transcript_1</td>
<td>Process_1</td>
<td>Up</td>
</tr>
<tr class="odd">
<td>Gene_1</td>
<td>Transcript_2</td>
<td>Process_1</td>
<td>Down</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="plotting" class="section level1">
<h1 class="hasAnchor">
<a href="#plotting" class="anchor"></a>Plotting</h1>
<p><code>tidygraph</code> uses a two tibble format, one for nodes and one for edges and displays it as a <strong>tbl_graph</strong> object, using a tidy manner to display both tibbles together</p>
<div class="sourceCode" id="cb2"><pre class="downlit">
<span class="kw">example_dataset_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"example_dataset.csv"</span>, package = <span class="st">"txGeneNetwork"</span>)
<span class="kw">example_dataset</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span>(<span class="kw">example_dataset_path</span>)
</pre></div>
<p>The tbl_graph() command allows you to directly create a tbl_graph object using our .csv table</p>
<div class="sourceCode" id="cb3"><pre class="downlit">
<span class="kw">example_tbl_graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/tbl_graph.html">as_tbl_graph</a></span>(<span class="kw">example_dataset</span>)
<span class="kw">example_tbl_graph</span>
</pre></div>
<pre><code>## # A tbl_graph: 119 nodes and 135 edges
## #
## # A directed acyclic multigraph with 2 components
## #
## # Node Data: 119 x 1 (active)
##   name                
##   &lt;chr&gt;               
## 1 Metabolism of Lipids
## 2 ACACA               
## 3 ACACB               
## 4 ACSL5               
## 5 AGPAT3              
## 6 ANKRD1              
## # … with 113 more rows
## #
## # Edge Data: 135 x 4
##    from    to Direction Group               
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;     &lt;chr&gt;               
## 1     1     2 &lt;NA&gt;      Metabolism of Lipids
## 2     1     3 &lt;NA&gt;      Metabolism of Lipids
## 3     1     4 &lt;NA&gt;      Metabolism of Lipids
## # … with 132 more rows</code></pre>
<div id="modified-ggplot2-syntax" class="section level2">
<h2 class="hasAnchor">
<a href="#modified-ggplot2-syntax" class="anchor"></a>Modified ggplot2 syntax</h2>
<p>Now that we have the <code>tbl_graph</code> object we can start plotting the data. GGraph uses a syntax very similar to ggplot2 and most of the addons used in <code>ggplot2</code> can also be used in <code>ggraph</code>, like <code>theme_*()</code> from <code>ggthemes</code> and geom_*_repel() from <code>ggrepel</code>. To start we will construct the basic network using the example data and after we add extra information for nodes and for edges. We will use geom_node_point() and geom_edge_link() for the basic network.</p>
<div class="sourceCode" id="cb5"><pre class="downlit">
<span class="kw">example_tbl_graph</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span>()
</pre></div>
<p><img src="txGeneNetwork_files/figure-html/fig1-1.png" width="480"></p>
<p>We got a message, saying that <code>ggraph</code> used <em>sugiyama</em> as default layout, that can be changed passing an argument to the <code><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph()</a></code> function call.</p>
<div class="sourceCode" id="cb6"><pre class="downlit">
<span class="kw">example_tbl_graph</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span>(layout = <span class="st">"kk"</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span>() <span class="op">+</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span>()
</pre></div>
<p><img src="txGeneNetwork_files/figure-html/fig2-1.png" width="288"></p>
<p>Now we have a network more similar to the final product. To modify our <code>tbl_graph</code> object and add other variables you can use usual <code>dplyr</code> syntax together with the <code><a href="https://tidygraph.data-imaginist.com/reference/activate.html">activate()</a></code> function. The <code><a href="https://tidygraph.data-imaginist.com/reference/activate.html">activate()</a></code> will select which of the tibbles you are modifying the nodes or the edges tibble. Here we add a centrality measure<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> to the network and size it accordingly using an <code>aes()</code> call inside <code><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point()</a></code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit">
<span class="kw">example_tbl_graph</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(centrality = <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/centrality.html">centrality_power</a></span>()) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span>(layout = <span class="st">"kk"</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span>(<span class="fu">aes</span>(size = <span class="kw">centrality</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span>()
</pre></div>
<p><img src="txGeneNetwork_files/figure-html/fig3-1.png" width="384"></p>
<p>We can also color de edges according to the process they belong to, or to the direction of the transcript expression, using a similar syntax, but now adding an <code>aes()</code> call inside <code><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link()</a></code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit">
<span class="kw">example_tbl_graph</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(centrality = <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/centrality.html">centrality_power</a></span>()) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span>(layout = <span class="st">"kk"</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span>(<span class="fu">aes</span>(col = <span class="kw">Direction</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span>(<span class="fu">aes</span>(size = <span class="kw">centrality</span>))
</pre></div>
<p><img src="txGeneNetwork_files/figure-html/fig4-1.png" width="384"></p>
<div class="sourceCode" id="cb9"><pre class="downlit">
<span class="kw">example_tbl_graph</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(centrality = <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/centrality.html">centrality_power</a></span>()) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span>(layout = <span class="st">"kk"</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span>(<span class="fu">aes</span>(col = <span class="kw">Group</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span>(<span class="fu">aes</span>(size = <span class="kw">centrality</span>))
</pre></div>
<p><img src="txGeneNetwork_files/figure-html/fig5-1.png" width="576"></p>
<p>As there are genes which belong to more than one biological process, this is not an adequate process visualization, the best way would be plotting it as individual hulls, but we will get to that down the workflow.</p>
</div>
<div id="adding-information-on-the-nodes" class="section level2">
<h2 class="hasAnchor">
<a href="#adding-information-on-the-nodes" class="anchor"></a>Adding information on the nodes</h2>
<p>For now in our example table we only added aesthetics to the edges, now we will add the transcript_type and the hull aesthetic. First you can extract the nodes table to then modify it using</p>
<div class="sourceCode" id="cb10"><pre class="downlit">
<span class="fu"><a href="https://tibble.tidyverse.org/reference/as_tibble.html">as_tibble</a></span>(<span class="kw">example_tbl_graph</span> <span class="op">%&gt;%</span> <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/activate.html">activate</a></span>(<span class="kw">nodes</span>))
</pre></div>
<pre><code>## # A tibble: 119 x 1
##    name                
##    &lt;chr&gt;               
##  1 Metabolism of Lipids
##  2 ACACA               
##  3 ACACB               
##  4 ACSL5               
##  5 AGPAT3              
##  6 ANKRD1              
##  7 ASAH1               
##  8 CYP2E1              
##  9 CYP4F3              
## 10 ESYT2               
## # … with 109 more rows</code></pre>
<p>Saving this on an object allows you to save and modify at will your nodes table. Here we load the modified table version</p>
<div class="sourceCode" id="cb12"><pre class="downlit">
<span class="kw">modified_nodes_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span>(<span class="st">"extdata"</span>, <span class="st">"modified_nodes.csv"</span>, package = <span class="st">"txGeneNetwork"</span>)

<span class="kw">modified_nodes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span>(<span class="kw">modified_nodes_path</span>)
</pre></div>
<p>We now add the transcript modified information in our tbl_graph object and plot it using the aes(col)</p>
<div class="sourceCode" id="cb13"><pre class="downlit">
<span class="kw">example_tbl_graph</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/activate.html">activate</a></span>(<span class="kw">nodes</span>) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(Type = <span class="kw">modified_nodes</span><span class="op">$</span><span class="kw">Type</span>) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(centrality = <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/centrality.html">centrality_power</a></span>()) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span>(layout = <span class="st">"kk"</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span>(<span class="fu">aes</span>(col = <span class="kw">Direction</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span>(<span class="fu">aes</span>(size = <span class="kw">centrality</span>, color = <span class="kw">Type</span>))
</pre></div>
<p><img src="txGeneNetwork_files/figure-html/fig6-1.png" width="624"></p>
<p>The geom_mark_hull(), the function to add the hull colors as process, does not work well with the <code>tbl_graph</code> object due to not being able to add multiple information for the same node in the same color. So the best way to color hulls is to add extra columns representing these sobrepositions and do one geom_mark_hull() call for each.</p>
<!-- TODO create a for loop or map() function to create columns based on the number of Pathways -->
<div class="sourceCode" id="cb14"><pre class="downlit">
<span class="kw">example_tbl_graph</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/activate.html">activate</a></span>(<span class="kw">nodes</span>) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(Type = <span class="kw">modified_nodes</span><span class="op">$</span><span class="kw">Type</span>, Process = <span class="kw">modified_nodes</span><span class="op">$</span><span class="kw">Process_1</span>, Process_2 = <span class="kw">modified_nodes</span><span class="op">$</span><span class="kw">Process_2</span>, Process_3 = <span class="kw">modified_nodes</span><span class="op">$</span><span class="kw">Process_3</span>) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(centrality = <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/centrality.html">centrality_power</a></span>()) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span>(layout = <span class="st">"kk"</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_mark_hull.html">geom_mark_hull</a></span>(<span class="fu">aes</span>(x = <span class="kw">x</span>, y = <span class="kw">y</span>, fill = <span class="kw">Process</span>, color = <span class="kw">Process</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_mark_hull.html">geom_mark_hull</a></span>(<span class="fu">aes</span>(x = <span class="kw">x</span>, y = <span class="kw">y</span>, fill = <span class="kw">Process_2</span>, color = <span class="kw">Process_2</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_mark_hull.html">geom_mark_hull</a></span>(<span class="fu">aes</span>(x = <span class="kw">x</span>, y = <span class="kw">y</span>, fill = <span class="kw">Process_3</span>, color = <span class="kw">Process_3</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span>(<span class="fu">aes</span>(col = <span class="kw">Direction</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggnewscale/man/new_scale.html">new_scale</a></span>(<span class="st">"color"</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span>(<span class="fu">aes</span>(size = <span class="kw">centrality</span>, color = <span class="kw">Type</span>))
</pre></div>
<p><img src="txGeneNetwork_files/figure-html/fig7-1.png" width="960"></p>
<p>Unfortunately, there is no way to plot this without the NA values due to the tbl_grpah type and how the geom_mark_hull works, so the NA hulls have to be removed <em>a posteriori</em>.</p>
</div>
<div id="final-touches" class="section level2">
<h2 class="hasAnchor">
<a href="#final-touches" class="anchor"></a>Final touches</h2>
<p>Now some final touches like legend size and title</p>
<div class="sourceCode" id="cb15"><pre class="downlit">
<span class="kw">example_tbl_graph</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/activate.html">activate</a></span>(<span class="kw">nodes</span>) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(Type = <span class="kw">modified_nodes</span><span class="op">$</span><span class="kw">Type</span>, Process = <span class="kw">modified_nodes</span><span class="op">$</span><span class="kw">Process_1</span>, Process_2 = <span class="kw">modified_nodes</span><span class="op">$</span><span class="kw">Process_2</span>, Process_3 = <span class="kw">modified_nodes</span><span class="op">$</span><span class="kw">Process_3</span>) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(centrality = <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/centrality.html">centrality_power</a></span>()) <span class="op">%&gt;%</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/ggraph.html">ggraph</a></span>(layout = <span class="st">"kk"</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_mark_hull.html">geom_mark_hull</a></span>(<span class="fu">aes</span>(x = <span class="kw">x</span>, y = <span class="kw">y</span>, fill = <span class="kw">Process</span>, color = <span class="kw">Process</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_mark_hull.html">geom_mark_hull</a></span>(<span class="fu">aes</span>(x = <span class="kw">x</span>, y = <span class="kw">y</span>, fill = <span class="kw">Process_2</span>, color = <span class="kw">Process_2</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggforce.data-imaginist.com/reference/geom_mark_hull.html">geom_mark_hull</a></span>(<span class="fu">aes</span>(x = <span class="kw">x</span>, y = <span class="kw">y</span>, fill = <span class="kw">Process_3</span>, color = <span class="kw">Process_3</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_edge_link.html">geom_edge_link</a></span>(<span class="fu">aes</span>(col = <span class="kw">Direction</span>)) <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggnewscale/man/new_scale.html">new_scale</a></span>(<span class="st">"color"</span>) <span class="op">+</span>
  <span class="fu"><a href="https://ggraph.data-imaginist.com/reference/geom_node_point.html">geom_node_point</a></span>(<span class="fu">aes</span>(size = <span class="kw">centrality</span>, color = <span class="kw">Type</span>))
</pre></div>
<p><img src="txGeneNetwork_files/figure-html/fig8-1.png" width="960"></p>
<p>There, now you have the final network and you only need to save it as .pdf or .csv and remove the NA layer of the hull.</p>
</div>
</div>
<div id="session-information" class="section level1">
<h1 class="hasAnchor">
<a href="#session-information" class="anchor"></a>Session information</h1>
<div class="sourceCode" id="cb16"><pre class="downlit">
<span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()
</pre></div>
<pre><code>## R version 4.0.2 (2020-06-22)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Catalina 10.15.6
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
##  [1] txGeneNetwork_0.0.0.9000 concaveman_1.1.0         ggnewscale_0.4.3        
##  [4] tidyr_1.1.2              readr_1.3.1              ggforce_0.3.2           
##  [7] tidygraph_1.2.0          ggraph_2.0.3             ggplot2_3.3.2           
## [10] knitr_1.29               BiocStyle_2.16.0        
## 
## loaded via a namespace (and not attached):
##  [1] tidyselect_1.1.0    xfun_0.16           purrr_0.3.4        
##  [4] graphlayouts_0.7.0  lattice_0.20-41     V8_3.2.0           
##  [7] colorspace_1.4-1    vctrs_0.3.4         generics_0.0.2     
## [10] htmltools_0.5.0     viridisLite_0.3.0   yaml_2.2.1         
## [13] utf8_1.1.4          rlang_0.4.7         pkgdown_1.6.0      
## [16] pillar_1.4.6        glue_1.4.2          withr_2.2.0        
## [19] tweenr_1.0.1        lifecycle_0.2.0     stringr_1.4.0      
## [22] munsell_0.5.0       gtable_0.3.0        ragg_0.3.1         
## [25] memoise_1.1.0       evaluate_0.14       labeling_0.3       
## [28] curl_4.3            fansi_0.4.1         Rcpp_1.0.5         
## [31] scales_1.1.1        backports_1.1.9     BiocManager_1.30.10
## [34] desc_1.2.0          cpp11_0.2.1         jsonlite_1.7.1     
## [37] farver_2.0.3        systemfonts_0.3.0   fs_1.5.0           
## [40] gridExtra_2.3       hms_0.5.3           digest_0.6.25      
## [43] stringi_1.4.6       bookdown_0.20       dplyr_1.0.2        
## [46] ggrepel_0.8.2       polyclip_1.10-0     grid_4.0.2         
## [49] rprojroot_1.3-2     cli_2.0.2           tools_4.0.2        
## [52] magrittr_1.5        tibble_3.0.3        crayon_1.3.4       
## [55] pkgconfig_2.0.3     Matrix_1.2-18       ellipsis_0.3.1     
## [58] MASS_7.3-51.6       assertthat_0.2.1    rmarkdown_2.3      
## [61] viridis_0.5.1       R6_2.4.1            igraph_1.2.5       
## [64] compiler_4.0.2</code></pre>
<div class="sourceCode" id="cb18"><pre class="downlit">
<span class="co"># sessioninfo::session_info()</span>
<span class="co"># xfun::session_info()</span>
</pre></div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
</div>
<div class="footnotes">
<hr>
<ol>
<li id="fn1"><p>add a reference about network statistics<a href="#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Izabela Mamede Costa Andrade da Conceição, Lucio Rezende Queiroz.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
